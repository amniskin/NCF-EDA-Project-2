---
title: "Best Places for Heart Disease?"
author: "Aaron Niskin, Chris Leonard, Lance Price, Nicole Navarro"
date: "November 30, 2016"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, message=FALSE}
library(tidyverse)
library(xtable)
setwd("~/Documents/courses/newCollege/current/eda/projects/project2/")
source("http://peterhaschke.com/Code/multiplot.R")
```

##Abstract

<!-- Chris's part -->

```{r}
complications <- read.csv("csv_files/main_complications.csv")
clot_quants <- quantile(complications$Score.Clot, na.rm = TRUE)
best_clots <- complications[!is.na(complications$Score.Clot) & complications$Score.Clot <= clot_quants[[2]], c("County.Name", "State")]
names(best_clots) <- c("County", "State")
worst_clots <- complications[!is.na(complications$Score.Clot) & complications$Score.Clot >= clot_quants[[4]], c("County.Name", "State")]
names(worst_clots) <- c("County", "State")
rm(clot_quants)
```

<!-- Lance's part -->


<!-- Aaron's part -->
##Prevention

>-  Factors
    1.  Nutrition
    2.  Smoking
    
##Nutrition

```{r, results='hold'}
smoking <- read.csv("csv_files/smoking.csv", stringsAsFactors = FALSE)
aggriData <- read.csv("csv_files/aggriculture_aggregated.csv", stringsAsFactors = FALSE)
names(aggriData) <- gsub("\\.", ",", gsub("_", "\\ ", names(aggriData)))
smoking <- smoking %>% mutate(County = toupper(County))
```

```{r}
smoking_quants <- quantile(smoking$percent_smoking, na.rm = TRUE)
best_smoking <- smoking[smoking$percent_smoking <= smoking_quants[[2]], c("County", "State")]
worst_smoking <- smoking[smoking$percent_smoking >= smoking_quants[[4]], c("County", "State")]
rm(smoking_quants)
```

```{r}
merged_best <- inner_join(best_clots, best_smoking, by=c("County", "State"))
merged_worst <- inner_join(worst_clots, worst_smoking, by=c("County", "State"))
```

```{r}
dats <- inner_join(smoking, aggriData, by=c("County", "State"))
dats_10 <- dats[,c(1, 2, 3, 9)]
names(dats_10) <- c("State", "County", "Percent_Smoking", "Low_Access_10_Miles_Share")
smoking_quants <- quantile(dats_10$Percent_Smoking)
worst_smoking <- smoking[smoking$percent_smoking >= smoking_quants[[4]], ]
best_smoking <- smoking[smoking$percent_smoking <= smoking_quants[[2]], ]

food_quants <- quantile(aggriData$`Low access, seniors age 65, at 10 miles, share`)
worst_food <- aggriData[aggriData$`Low access, seniors age 65, at 10 miles, share` >= food_quants[[3]],]
best_food <- aggriData[aggriData$`Low access, seniors age 65, at 10 miles, share` <= food_quants[[2]],]
best_counties_food_and_smoking <- inner_join(best_food, best_smoking, by=c("State", "County")) %>% mutate(County = toupper(County))
worst_counties_food_and_smoking <- inner_join(worst_food, worst_smoking, by=c("State", "County")) %>% mutate(County = toupper(County))
```

```{r, results='show'}
ggplot(data=dats_10, aes(Low_Access_10_Miles_Share)) + geom_density(fill='tomato2') + labs(title="Density Plot for Smoking Percentage of Population", x="Percentage of Population that Smokes")
```

##Smoking

```{r, results='show'}
ggplot(data=dats_10, aes(Percent_Smoking)) + geom_density(fill='turquoise3') + labs(x="Percentage of Smokers in Population")
```

##Relationship Between Nutrition And Smoking


```{r, results='show'}
ggplot(data=dats_10, aes(x=Low_Access_10_Miles_Share, y=Percent_Smoking)) + geom_point(alpha=0.8, size=0.2) + geom_smooth() + labs(x="Poor Access to Supermarkets", y="Percentage of Smokers in Population", title="Smoking Percentage vs Access to Nutrition")
```

##Obesity

```{r}
countyHealth <- read.csv("csv_files/countyHealthRankings.csv")
ggplot(data=countyHealth, aes(x=Obesity)) + geom_density(fill='darkolivegreen2') + labs(title="Percentage of Obesity in Population")
```

##More Relations
```{r, results='show'}
tmpDf <- dats_10 %>% gather("Field", "Percentage", 3:4)
tmpDf$Field = as.character(gsub("Percent_Smoking", "Smokers", tmpDf$Field))
tmpDf$Field = as.character(gsub("Low_Access_10_Miles_Share", "Low Nutritional Access", tmpDf$Field))
ggplot(data=tmpDf) + geom_density(aes(x=Percentage, fill=Field))
```

